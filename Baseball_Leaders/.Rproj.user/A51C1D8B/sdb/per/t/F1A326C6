{
    "collab_server" : "",
    "contents" : "rm(list=ls())\nlibrary(tidyverse)\nlibrary(Lahman)\nlibrary(lubridate)\n\n# Updates them_minimal so that there is borders around the graphs and the facet headings.\ntheme_minimal2 <- theme_minimal() %>%  theme_set()\ntheme_minimal2 <-\n  theme_update(\n    panel.border = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n    ,strip.background = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n  )\n\n# Year to go up to\nyr <- 2017\nn <- 22\ntest <- quo(G)\n\nBatting_tib <- \n  Batting %>% \n  as.tibble()\n\n\n\n# Provides cumulative stats for each player up to this year.\nbatting_cum <- \n  Batting_tib %>% \n  filter(yearID <= yr) %>% \n  group_by(playerID) %>% \n  mutate(Cum_HR = cumsum(!!test)) %>% \n  arrange(desc(Cum_HR)) %>% \n  distinct(\n    playerID\n    ,.keep_all = TRUE\n  ) %>%\n  head(n) %>%\n  mutate(\n    `First Name` = playerInfo(playerID)[1, ]$nameFirst\n    ,`Last Name` = playerInfo(playerID)[1, ]$nameLast\n  ) %>%\n  mutate(\n    `Full Name` = paste0(`Last Name`, \", \", `First Name`)\n  )\n\n\ntop_n_bar_chart <- \n  ggplot(\n    batting_cum%>% \n      head(n)\n    ,aes(\n      x = `Full Name`\n      ,y = Cum_HR\n    )\n  ) +\n  geom_col(\n    alpha = 0.75\n  ) +\n  labs(\n    title = paste(\"Top\", n, \"Players by Cumulative HR's in\", yr)\n    ,y = \"Cumulative HR's\"\n  )\ntop_n_bar_chart\n  ",
    "created" : 1501595716854.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4113221015",
    "id" : "F1A326C6",
    "lastKnownWriteTime" : 1501601116,
    "last_content_update" : -2147483648,
    "path" : "~/GitHub/shiny-server/Baseball_Leaders/top_n_leaderboard.R",
    "project_path" : "top_n_leaderboard.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}