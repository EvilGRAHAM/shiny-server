{
    "collab_server" : "",
    "contents" : "rm(list=ls())\nlibrary(tidyverse)\nlibrary(Lahman)\nlibrary(lubridate)\n\n# Updates them_minimal so that there is borders around the graphs and the facet headings.\ntheme_minimal2 <- theme_minimal() %>%  theme_set()\ntheme_minimal2 <-\n  theme_update(\n    panel.border = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n    ,strip.background = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n  )\n\n# Year to go up to\nyr <- 2017\nn <- 10\nstat_input <- quo(G)\n\nBatting_tib <- \n  Batting %>% \n  as.tibble()\n\n\n\n# Provides Career stats for each player up to this year.\nbatting_Career <- \n  Batting_tib %>% \n  filter(yearID <= yr) %>% \n  group_by(playerID) %>% \n  mutate(Career_HR = cumsum(!!stat_input)) %>% \n  arrange(desc(Career_HR)) %>% \n  distinct(\n    playerID\n    ,.keep_all = TRUE\n  ) %>%\n  head(n) %>%\n  mutate(\n    `First Name` = playerInfo(playerID)[1, ]$nameFirst\n    ,`Last Name` = playerInfo(playerID)[1, ]$nameLast\n  ) %>%\n  mutate(\n    `Full Name` = paste0(`Last Name`, \", \", `First Name`)\n  ) %>% \n  ungroup()\n\n\ntop_n_bar_chart <- \n  ggplot(\n    batting_Career %>% \n      head(n)\n    ,aes(\n      x = factor(`Full Name`, levels = `Full Name`[order(batting_Career$Career_HR %>% head(n) %>% desc())])\n      ,y = Career_HR\n    )\n  ) +\n  geom_col(\n    alpha = 0.75\n  ) +\n  labs(\n    title = paste(\"Top\", n, \"Players by Career HR's in\", yr)\n    ,y = \"Career HR's\"\n  )\ntop_n_bar_chart\n  ",
    "created" : 1501603365444.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1554445606",
    "id" : "5B4E5326",
    "lastKnownWriteTime" : 1501604403,
    "last_content_update" : -2147483648,
    "path" : "~/GitHub/shiny-server/Baseball_Leaders/top_n_leaderboard.R",
    "project_path" : "top_n_leaderboard.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}