{
    "collab_server" : "",
    "contents" : "# Libraries ----------\nlibrary(shiny)\nlibrary(shinythemes)\nlibrary(tidyverse)\nlibrary(Lahman)\nlibrary(lubridate)\n\n# ggplot Formatting ----------\n# Updates theme_minimal so that there is borders around the graphs and the facet headings.\ntheme_minimal2 <- theme_minimal() %>%  theme_set()\ntheme_minimal2 <-\n  theme_update(\n    panel.border = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n    ,strip.background = element_rect(\n      linetype = \"solid\"\n      ,colour = \"grey92\"\n      ,fill = NA\n    )\n  )\n\n# Loads Batting dataset as tibble.\nBatting_tib <- \n  Batting %>% \n  as.tibble()\n\n#Server ----------\nshinyServer(\n  function(input, output) {\n    \n    # Dataset ----------\n    batting_Career <- reactive({\n      # Adds a progress bar to show the calculations are running.\n      withProgress(\n        message = \"Calculating...\"\n        ,value = NULL\n        ,Batting_tib %>% \n          filter(yearID <= input$year_lkup) %>% \n          group_by(playerID) %>% \n          mutate(\n            Career_Stat = cumsum(!!quo(eval(parse(text = input$baseball_stat))))\n          ) %>% \n          arrange(desc(Career_Stat)) %>% \n          # Removes cases where a player appears multiple times in the list due to being a leader for multiple years.\n          distinct(\n            playerID\n            ,.keep_all = TRUE\n          ) %>% \n          head(100) %>% \n          mutate(\n            # Incase more than one name is returned, we choose the first one, as it should be the exact match.\n            `Full Name` = paste0(playerInfo(playerID)[1, ]$nameLast, \", \", playerInfo(playerID)[1, ]$nameFirst)\n          )\n      )\n    })\n    \n    # Leaderboard Table ----------\n    output$leaderboardTable <- renderTable({\n      \n      batting_Career() %>%\n        # Grabs the top n values.\n        head(input$n) %>% \n        ungroup() %>% \n        select(\n          -c(\n            playerID\n            ,yearID\n            ,stint\n            ,teamID\n            ,lgID\n          )\n        )\n      \n    })\n    \n    # Leaderboard Plot ----------\n    output$leaderboardPlot <- renderPlot({\n      \n      ggplot(\n        batting_Career() %>% \n          head(input$n)\n        ,aes(\n          x = factor(`Full Name`, levels = `Full Name`[order(batting_Career()$Career_Stat %>% head(input$n) %>% desc())])\n          ,y = Career_Stat\n        )\n      ) +\n        geom_col(\n          alpha = 0.75\n        ) +\n        labs(\n          title = paste0(\"Top \", input$n, \" Players by Career \", input$baseball_stat, \"'s in \", input$year_lkup)\n          ,x = \"Player\"\n          ,y = paste0(\"Career \", input$baseball_stat, \"'s\")\n        )\n      \n    })\n    \n  })\n",
    "created" : 1501595717500.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2619310414",
    "id" : "BBA37D5F",
    "lastKnownWriteTime" : 1501604387,
    "last_content_update" : 1501604387,
    "path" : "~/GitHub/shiny-server/Baseball_Leaders/server.R",
    "project_path" : "server.R",
    "properties" : {
        "docOutlineVisible" : "1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}